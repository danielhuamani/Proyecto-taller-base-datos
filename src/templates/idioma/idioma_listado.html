{% extends 'common/base.html' %}

{% block css %}
<link href="{{STATIC_URL}}plugins/datatables/dataTables.bootstrap.css" rel="stylesheet" type="text/css">
{% endblock css %}
{% block content %}

<div class="row">
  <div class="col-xs-12">
   <div class="box box-primary">

    <div class="box-body">

      <div id="example1_wrapper" class="dataTables_wrapper form-inline dt-bootstrap">
            <table id="example1" class="table table-bordered table-striped dataTable" role="grid" aria-describedby="example1_info">
             <thead>
              <tr>
                <th>NÂ°</th>
                <th>Nombres</th>
              </tr>
            </thead>
              <tbody class="listado_idioma">
              {% for idioma in idiomas %}
                <tr role="row" class="odd">
                  <td class="sorting_1">{{forloop.counter}}</td>
                  <td><a href="#">{{idioma.nombre}}</a></td>
                </tr>
               {% endfor %}
              </tbody>

              </table>
      </div>
      <div class="btn-group mb_20">
        <button type="button" id="agregar_idioma" class="btn btn-success">Agregar Idioma</button>
      </div>
      <form action="#" method="POST" id="form_idioma">
        <div class="cnt-formulario">
        </div>
        <button type="button" id="guarda_idioma" class="btn btn-success"><i class="fa fa-fw fa-save"></i> Guardar</button>
      </form>
    </div><!-- /.box-body -->
  </div>
</div>

{% endblock content %}
{% block javascript %}

<!-- FastClick -->

    <!-- DATA TABES SCRIPT -->

    <!-- SlimScroll -->
    <script src="{{STATIC_URL}}plugins/slimScroll/jquery.slimscroll.min.js" type="text/javascript"></script>
    <!-- FastClick -->
    <script src='{{STATIC_URL}}plugins/fastclick/fastclick.min.js'></script>
    <script src='{{STATIC_URL}}js/jquery_formset.js'></script>
     <script src='{{STATIC_URL}}js/cookies.js'></script>
    <!-- AdminLTE App -->

    <script type="text/javascript">

      $(document).ready(function() {
        $("body").on('click', '#agregar_idioma', function(event) {
            /* Act on the event */
            event.preventDefault()
            var contador_formulario = $(".formulario_inicial").length + 1
            html = '<div class="formulario_inicial form-group"><label for="">Nombre del Idioma</label><input type="text" class="idioma_nombre" name="idioma"></div>'
            $(".cnt-formulario").append(html)
        });
        $("#guarda_idioma").click(function(event) {
            /* Act on the event */
            var arreglo_idiomas = new Array()
            $(".idioma_nombre").each(function(index, el) {
                arreglo_idiomas.push($(this).val())
            });
            console.log(JSON.stringify(arreglo_idiomas))
            var frmdata = $("#form_idioma").serialize()
            console.log(frmdata)
            $.ajax({
                url: '{% url "idioma:api_idioma_agregar" %}',
                type: 'POST',
                data: {'idioma': JSON.stringify(arreglo_idiomas)},

            })
            .done(function(data) {
                console.log(data);
            })


        });
       // $(".formulario_inicial").formset({
       //  prefix: "{{form.prefix}}",
       //  deleteText: "Eliminar",
       //  addCssClass:"Agregar idioma"
       // })
      });
    </script>
{% endblock javascript %}
